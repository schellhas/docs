Lecture 3 - Scheduling
======================

Standard strategies
-------------------

- **FCFS**      First Come First Served
- **LCFS**      Last Come First Served
- **LCFS-PR**   Last Come First Served-Preemptive Resume
- **RR**        Round Robin
- **PRIO-NP**   Priorities (non-preemptive)
- **Prio-P**    Priorities (preemptive)
- **SPN**       Shortest Process Next
- **SRTN**      Shortest Remaining Time Next
- **HRRN**      Highest Resposne Ratio Next
- **FB**        Multilevel Feedback

**FCFS** - First Come First Served
------------------------------

Execution of threads in the order of arrival at the ready list, occupation of processor until end of process or voluntary yield.

.. image:: 3fcfs.png

**LCFS** - Last Come First Served
-----------------------------

Execution of threads in reversed order of arrival at the ready list. Occupation of processor until end or voluntary yield.

.. image:: 3lcfs.png

**LCFS-PR** - Last Come First Served - Preemptive Resume
--------------------------------------------------------

Newly arriving thread at ready list preempts the currently running thread. Preempted thread is appended to ready list. In case of no further arrivals, the ready list is processed without preemption.

Goal is to prefer short threads, these have a good chance to finish before another thread arrives. A long thread is likely to be preempted several times.

.. image:: 3lcfs-pr.png

**RR** - Round Robin (time slicing)
-----------------------------------

Processing of thread in order of arrival. After some prespecified time (time slice τ) preemption takes place and we switch to the next thread.

Goal is the even distribution of processor capacity and waiting time to the competing threads. Selection of τ is an optimization problem, because:

- For larger τ, RR approaches FCFS
- For small τ, the overhead of frequent switching is a performance penalty

Usual are time slices in the order of some tens of milliseconds.

.. image:: 3rr.png

**PRIO-NP** - Priorities - nonpreemptive
----------------------------------------

Newly arriving threads are inserted in the ready list according to their priority. Once assigned, they stay running on the processor until they finish or voluntarily relinquish the processor.

.. image:: 3prio-np.png

**PRIO-P** - Priorities - preemptive
------------------------------------

Like PRIO-NP except that we check for preemption, i.e. the running thread is being preempted if it has a lower priority than the new thread.

.. image:: 3prio-p.png

**SPN** - Shortest Process Next
-------------------------------

Thread with shortest service time is executed next until it finishes. Like PRIO-NP, if we consider service time as priority criterion.

Favors short threads and thus leads to shorter mean response time than FCFS. Also known as Shortest Job Next (SJN).

.. image:: 3spn.png

**SRTN** - Shortest Remaining Time Next
---------------------------------------

Thead with shortest remaining service time is executed next. Currently running thread may be preempted.

Both strategies have disadvantage that they need a-priori knowledge of service times that may be available only as users estimates. Long threads may starve when always shorter threads are available.

.. image:: 3srtn.png

**HRRN** - Highest Response Ratio Next
--------------------------------------

The response ratio *rr* is defined as:

.. math::

	\text{rr} := \frac{\text{waiting time + service time}}{\text{service time}}

*rr* is calculated dynamically and used as priority: The thread with the highest *rr*-value is selected. The strategy is non-preemptive.

As with SPN short threads are favoured. However, long threads do not need to wait forever but score some points by waiting.

.. note::

	What about the "beginning"? When all threads have a waiting time of 0? Then all the *rr*s should be exactly 1. So we just do FCFS?

.. image:: 3hrrn.png

**FB** - (Multilevel) Feedback
------------------------------

If we do not know the service time a priori, but want to favor short threads we can reduce its "priority" stepwise at each CPU-usage. The individual waiting queues can be managed according to "round robin". Different  values of time slices τ for the individual queues are possible.

.. image:: 3fb1.png

.. image:: 3fb2.png

Standard strategies (summary)
-----------------------------

.. raw:: html

	<table border="1">
		<tr>
			<th rowspan="2"></th>
			<th colspan="2">without preemption</th>
			<th colspan="2">with preemption</th>
		</tr>
		<tr>
			<th>without priorities</th>
			<th>with priorities</th>
			<th>without priorities</th>
			<th>with priorities</th>
		</tr>
		<tr>
			<td>Service time independent</td>
			<td><b>FCFS, LCFS</b></td>
			<td><b>PRIO-NP</b></td>
			<td><b>LCFS-PR, RR, FB</b></td>
			<td><b>PRIO-P</b></td>
		</tr>
		<tr>
			<td>Service time dependent</td>
			<td><b>SPN, HRRN</b></td>
			<td></td>
			<td><b>SRTN</b></td>
			<td></td>
		</tr>
	</table>